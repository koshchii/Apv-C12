# Apv-C12

> This package contains a modification of the ELSEPA code by F. Salvat, A. Jablonski, and C. J. Powell  [_Comp. Phys. Comm. 165, 157 (2005)_](https://www.sciencedirect.com/science/article/abs/pii/S0010465504004795?via%3Dihub) to make predictions for the parity-violating asymmetry (_A<sup>PV</sup>_) in elastic electron scattering from a <sup>12</sup>C nucleus. In addition, it includes two Mathematica notebooks that can be used for a feasibility study of a simultaneous sub-percent extraction of the weak charge and the weak radius of the <sup>12</sup>C nucleus. Theoretical details of the analysis and results of the calculation are discussed in the paper by O. Koshchii, J. Erler, M. Gorchtein, C. J. Horowitz, J. Piekarewicz, X. Roca-Maza, C.-Y. Seng, and H. Spiesberger, published in the Physical Review C journal: [Phys. Rev. C102, 022501 (2020)](https://journals.aps.org/prc/abstract/10.1103/PhysRevC.102.022501) (a preprint is available on arXiv: [arXiv:2005.00479](https://arxiv.org/abs/2005.00479)).

The ELSEPA source package is available on [Mendeley](https://mendeley.figshare.com/articles/dataset/elsepa_Dirac_partial-wave_calculation_of_elastic_scattering_of_electrons_and_positrons_by_atoms_positive_ions_and_molecules/11332520) and is  distributed under a [CC BY 4](https://creativecommons.org/licenses/by/4.0/) license. 


## Table of Contents

* [Setup](#setup)
* [Usage](#usage-of-elsepa-related-files)
* [Input parameters](#input-parameters)
* [General information](#general-information)

## Setup

The distribution package consists of Fortran 77 programs (source code files) and Mathematica notebooks. 7 files are included:
1. ELSEPA-related files (3 files):
    1. `elsepa.f` - calculation of elastic scattering of electrons and positrons by nuclei. Dirac partial wave analysis for real and complex central potentials; high-energy factorizations.
    2. `apv.f` -  the main program file for predicting _A<sup>PV</sup>_ in elastic electron-nucleus scattering.
    3. `mycase.in` --  example of an input data file for 'apv'. Relevant input parameters that can be changed for obtaining various predictions for _A<sup>PV</sup>_ are: `MNUCL`, `MODF`, `MWEAK`, `WKSK`, and `EV`. The meaning of these parameters is described inside the input file and in [Input parameters](#input-parameters) section. Other parameters should not be changed, and they are marked as NC (no change) inside the input file.

2. Supplementary files (2 files): 
    1. `README.md` -  the present file with documentation.
    2. `Makefile` -  makefile.

3. Mathematica notebooks (2 files):
    1. `Fig2.nb` 
    2. `Fig3-4.nb` 

These Mathematica notebooks are external to the ELSEPA code. They can be used together with output files produced by ELSEPA to perform a feasibility study of a simultaneous extraction of the weak charge and the weak radius of the <sup>12</sup>C nucleus. In order to reproduce Fig. 2 of [Phys. Rev. C102, 022501 (2020)](https://journals.aps.org/prc/abstract/10.1103/PhysRevC.102.022501), 4 output files need to be generated by ELSEPA and have to be placed in the same folder as the notebook `Fig2.nb`. For example, for beam energy in laboratory frame E=155 MeV (the parameter `EV` is set to 1.55E8 inside `mycase.in`) these output files will be called `dcs_1p523e08m4-sf+.dat`, `dcs_1p523e08m4-sf-.dat`, `dcs_1p523e08m4-ns+.dat`, and `dcs_1p523e08m4-ns-.dat`). Similarly, in order to reproduce Figs. 3-4 of [Phys. Rev. C102, 022501 (2020)](https://journals.aps.org/prc/abstract/10.1103/PhysRevC.102.022501), 10 ELSEPA output files called `nuclmodel_001+.dat`, `nuclmodel_001-.dat`, ..., `nuclmodel_005+.dat`, `nuclmodel_005-.dat` need to be palced in the same folder as the notebook `Fig3-4.nb`. The details on how to produce the corresponding output files are discussed below.


## Usage of ELSEPA-related files

1. Generate the executable binary file 'apv.exe' using your Fortran compiler. For example, when I use the gfortran compiler in Linux, this executable is generated by means of the following command:

       gfortran -fno-align-commons -fno-automatic -ffixed-line-length-none -std=legacy apv.f -o apv.exe
      Alternatively, one can generate the executable file using the `make` command. If your compiler is different from gfortran, the Makefile needs to be modified appropriately.

2. Use/modify the input datafile 'mycase.in' for your problem.

3. Execute the code by entering the command:
            
    `./apv.exe < mycase.in` 
      
   which redirects the standard input unit (=5) to your input data file.


## Input Parameters

The program 'apv.f' reads data from the input file 'mycase.in', whose structure is described in the heading comments of the Fortran 77 'apv.f' source file. A short description of relevant input parameters is provided below:

* `MNUCL` - parameter that determines the model used for distribution of the nuclear charge. The sum of Gaussians model (`MNUCL = 4`) is known to describe the best the distribution of nuclear charge.   

* `WKSK` - weak skin parameter that sets the value of the weak skin of the nucleus in units of the charge radius. In other words, it sets the value for _(R<sub>wk</sub>-R<sub>ch</sub>)/R<sub>ch</sub>_. It is relevant for calculations with `MODF = 0` and is overwritten otherwise.

* `MWEAK` - weak density/skin distribution parameter. When `MWEAK = 1`, the distribution of the weak charge is assumed to be identical to that of the nuclear charge. When `MWEAK = 2`, the weak skin is assumed to be generated by the difference between symmetrized Fermi and nuclear charge distributions.   

* `MODF` - parameter that determines if sensitivity to higher moments should be investigated (`MODF = 1-5`) or not (`MODF = 0`). When `MODF` is set to be 0, then the weak skin of the nucleus is assumed to be fixed to the value given by the `WKSK` parameter. When `MODF` is set to be 1-5, then the calculation will be repeated 201 times for different values of the weak skin parameter: from 0 to -0.02 with a step of -0.0001 (can be changed inside the `apv.f` file). The values 1-5 determine which nuclear model is used for the parametrization of the weak skin.

## General Information

When `MODF = 0`, the output filenames are given in the following format:\
\
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   'dcs_x1mx2-x3x4.dat', where\
\
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    x1 - input value for the parameter `EV` (beam energy in eV, in the E form format: x.yyyezz)\
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    x2 - input value for the parameter `MNUCL` (1, 2, 3, or 4)\
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    x3 - input value for the parameter `MWEAK` (0 --> x3 = nw, 1 --> x3 = ns, 2 --> x3 = sf, 3 --> x3 = hm)\
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    x4 - value for the beam helicity parameter (+, -, or nothing)

When `MODF = 1-5`, the output filenames are given in the following format:\
\
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   'nuclmodel_x1x2.dat', where\
\
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    x1 - input value for the parameter `MODF` (001...005)\
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    x2 - value for the beam helicity parameter (+, -)

Several subroutines write partial information (phase shifts, absorptive potential, ...) on the standard output unit (=6) as the calculation progresses; they may also generate files with the extension '*.dat' with self-explanatory contents. This does not impair the calculation speed and helps the user to get a  feeling of the time that a planned calculation may take and to track partial results of the calculation. 
   
Typical running times with the parameter `MODF = 0` are several seconds and with `MODF = 1-5` are several minutes.

To reproduce Fig. 2 of [Phys. Rev. C102, 022501 (2020)](https://journals.aps.org/prc/abstract/10.1103/PhysRevC.102.022501), generate output files by running the code twice using the following input: a) `MNUCL=4`, `MODF=0`, `MWEAK=2`, `WKSK=-0.00895`, `EV=1.55E8`, b) same as in a) but with `MWEAK=1`.

To reproduce Figs. 3-4 of [Phys. Rev. C102, 022501 (2020)](https://journals.aps.org/prc/abstract/10.1103/PhysRevC.102.022501), generate output files by running the code 5 times by changing `MODF` from 1 to 5 and keeping `MNUCL=4`, `MWEAK=2`, and `EV=1.55E8`. The second column in 'nuclmodel_x1x2.dat' is the lab frame scattering angle, the third column is the differential cross section, and the last column is the weak skin parameter.

